__mjsload("flash",'\'use strict\';function d(e,d){this._genId();for(var g in d)d.hasOwnProperty(g)&&(this[g]=d[g]);this.flashVars={callback:this._getKey("swfCallbackId")};this.flashVars.protocol=Q;this.status=0;this.waitQuene=[];this.view=e;this._isFirstChange=this._isFristLoadFlash=!0;this._labels={};this._labelsArr=[];this._plugins={};this._bindSwfCallback();this.createPano();this._initEvents();this.view._render=this}function g(e){return document.getElementById(e)}function k(e){return"[object Number]"==Object.prototype.toString.call(e)&&isFinite(e)}function h(e,d){e=Math.round(10*e)/10;d=Math.round(10*d)/10;return e==d}function u(e){e=Math.log(Math.tan(.008726646259971648*(90+e)))/.017453292519943295;return e*ca}function x(e){e/=ca;return 114.59155902616465*Math.atan(Math.exp(.017453292519943295*e))-90}function G(e){var d=[],g;for(g in e)e.hasOwnProperty(g)&&d.push(g+"="+encodeURIComponent(e[g]));return d.join("&")}function S(){var e=navigator.userAgent;return/gecko/i.test(e)&&!/like gecko/i.test(e)}function O(){return/msie (\\d+\\.\\d+)/i.test(navigator.userAgent)?document.documentMode||+RegExp.$1:0}function R(e,d){e=e.split(".");d=d.split(".");for(var g=Math.max(e.length,d.length),k=0;k<g;k++){var h=e[k],m=d[k];if(!h||!m)return h||m?h?1:-1:0;h=Number(h);m=Number(m);if(h<m)return-1;if(h>m)return 1}return 0}function p(e){var d=O()?\' classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase=\'+Q+\'"fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0"\':\' type="application/x-shockwave-flash"\',g=["id","width","height","align","data"],k="wmode movie flashvars scale quality play loop menu salign bgcolor base allowscriptaccess allownetworking allowfullscreen seamlesstabbing devicefont swliveconnect".split(" ");e=e||{};a:{var h;h=e.minVer;var m=e.maxVer;if(h||m){var p,t=O();if(null==p){var u=navigator;if(u.plugins&&u.mimeTypes.length)(t=u.plugins["Shockwave Flash"])&&t.description&&(p=t.description.replace(/([a-zA-Z]|\\s)+/,"").replace(/(\\s)+r/,".")+".0");else if(t)try{var x=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");x&&(p=x.GetVariable("$version").replace(/WIN/g,"").replace(/,/g,"."))}catch(G){}}if(!p||h&&0>R(p,h)||m&&0<R(p,m)){e=e.altHtml||"";break a}}m=["<object",d];e.data=e.movie;for(d=0;d<g.length;d++)h=g[d],e.hasOwnProperty(h)&&m.push(" ",h,\'="\',e[h],\'"\');m.push(">");for(d=0;d<k.length;d++)h=k[d],e.hasOwnProperty(h)&&m.push(\'<param name="\',h,\'" value="\',e[h],\'"/>\');m.push("</object>");e=m.join("")}return e}var t=ma,P=/(\\d+\\.\\d)?(?:\\.\\d)?\\s+safari\\/?(\\d+\\.\\d+)?/i.test(t)&&!/chrome/i.test(t)?+(RegExp.$1||RegExp.$2):0,Q="https:"==window.location.protocol?"https://":"http://",L=Q+"s.map.qq.com/TPano/TPanoFlash/v1.4.1/plugins/",J={movie:Q+"s.map.qq.com/TPano/TPanoFlash/v1.4.1/core/TPano.swf",altHtml:\'<div style="position: relative;width: 300px;background-color:#FFEFB6;border: 1px solid #FFC337;margin: 65px auto;padding: 10px;"><p>\\u4f7f\\u7528\\u817e\\u8baf\\u8857\\u666f\\uff0c\\u9700\\u8981\\u5c06\\u60a8\\u7684Adobe Flash Player \\u64ad\\u653e\\u5668\\u5347\\u7ea7\\u523010\\u6216\\u66f4\\u65b0\\u7248\\u672c</p><div><a href="https://get.adobe.com/cn/flashplayer/" target="_blank;">\\u4e0b\\u8f7d\\u6700\\u65b0\\u7248\\u672c</a></div></div>\',minVer:"10.0.0",width:"100%",height:"100%",bgcolor:"#EEEEEE",wmode:"transparent",align:"middle",quality:"high",allowscriptaccess:"always",allowfullscreen:"true",menu:!1},ca=111319.49077777778,ga=0;window.checkJSReady=function(){return!0};t=d.prototype;t._setKey=function(e,d){var g=this[e];g&&g==d||(this[e]=d)};t._getKey=function(e){return this[e]};t.createPano=function(){var e=this.flashVars;e.panoId=this._getKey("pano");var d=this._getKey("pov");d&&(null!==d.heading&&(e.heading=d.heading),null!==d.pitch&&(e.pitch=d.pitch));null!==this._getKey("zoom")&&(e.zoom=parseInt(this._getKey("zoom")));this._getKey("disableMove")&&(e.disableMove=this._getKey("disableMove"));this._getKey("pf")&&(e.pf=this._getKey("pf"));this._getKey("ch")&&(e.ch=this._getKey("ch"));this._getKey("key")&&(e.key=this._getKey("key"));e.keystatus=1;d=[];J.id=this._getKey("swfId");J.flashvars=G(e);e=p(J);d.push(e);e=document.createElement("div");e.style.width="100%";e.style.height="100%";!1===this._getKey("visible")&&(e.style.visibility="hidden");e.innerHTML=d.join("");this._setKey("panoContainer",e);d=this._getKey("container");("object"==typeof d?d:document.getElementById(d)).appendChild(e);this.status=1;if(-1==window.location.href.indexOf(Q)){var g=this;setTimeout(function(){g.checkCommunication()},3e3)}};t.setKeyStatus=function(e){this._sendToAs("setKeyStatus",e)};t.removePano=function(){this.status=0;this.waitQuene=[];this._isFristLoadFlash=!0;var e=g(this._getKey("swfId"));if(e){var d=O();if(e&&d){e.style.display="none";for(var r in e)"function"===typeof e[r]&&(e[r]=null);window.CollectGarbage&&setTimeout(window.CollectGarbage,0)}d=document.createElement("div");d.appendChild(e);d.innerHTML="";e=this._getKey("container");("object"==typeof e?e:document.getElementById(e)).removeChild(this._getKey("panoContainer"))}};t.setVisible=function(e){this._getKey("visible")!=e&&(this._setKey("visible",e),this._getKey("panoContainer").style.visibility=e?"visible":"hidden")};t.setPano=function(e){if(!e)this._setKey("pano",null);else if(e&&e!==this._getKey("pano")){this._getKey("pano")||(this._setKey("pano",e),this.removePano(),this.createPano(),this._initEvents());var d={svid:e};this._setKey("_setPanoValue",{svid:e});this._sendToAs("setPanoOptions",d)}};t.setThumb=function(e){this._sendToAs("setThumb",e.globe)};t.setPov=function(e){var d=this._getKey("pov"),g={},h=!1;!e||!k(e.heading)||d&&d.heading===e.heading||(g.heading=Math.round(10*e.heading)/10,h=!0);!e||!k(e.pitch)||d&&d.pitch===e.pitch||(g.pitch=Math.round(10*e.pitch)/10,h=!0);h&&(this._setKey("_setPovValue",g),this._sendToAs("setPanoOptions",g))};t.setZoom=function(e){var d=this._getKey("zoom");parseInt(e)!=d&&(d={zoom:parseInt(e)},this._setKey("_setZoomValue",parseInt(e)),this._sendToAs("setPanoOptions",d))};t.pano_changed=function(e){var d=this._getKey("pano");if(d&&d!=e||this._isFirstChange)this._setKey("pano",e),this._setKey("_setPanoValue",e),this.view.fireEvent("pano_changed",e,this.view)};t.pov_changed=function(e){var d=this._getKey("pov")||{};this._pov=e;var g=0,k={};d&&(k.heading=d.heading,k.pitch=d.pitch);d&&h(e.heading,d.heading)||(k.heading=e.heading,g=1);d&&h(e.pitch,d.pitch)||(k.pitch=e.pitch,g=1);if(g||this._isFirstChange)this._setKey("pov",k),this._setKey("_setPovValue",k),this.view.fireEvent("pov_changed",k,this.view)};t.zoom_changed=function(e){if(e!==this._getKey("zoom")||this._isFirstChange)this._setKey("zoom",e),this._setKey("_setZoomValue",e),this.view.fireEvent("zoom_changed",e,this.view)};t.addLabel=function(e){this._labels[e.id]||(this._labelsArr.push(e),this._labels[e.id]=e,this._sendToAs("addLabel",{id:e.id,lat:u(e.position.lat),lng:e.position.lng*ca,height:e.altitude,content:e.content}))};t.removeLabel=function(e){this._sendToAs("removeLabel",{id:e});this._labels[e]=void 0;for(var d=0;d<this._labelsArr.length;d++)this._labelsArr[d].id==e&&this._labelsArr.splice(d,1)};t.addPlugin=function(e){this._sendToAs("addPlugin",{name:e.id,options:{url:L+e.name}});this._plugins[e.id]||(this._plugins[e.id]=e)};t.autoPlayStart=function(e){this._sendToAs("autoPlayStart",e)};t.autoPlayStop=function(){this._sendToAs("autoPlayStop")};t._onInterfaceReady=function(){for(this.status=2;0<this.waitQuene.length;){var e=this.waitQuene.shift();this._sendToAs(e.eventName,e.data,e.tp)}};t._addDefalutPlugin=function(){(!this._getKey("disableMove")||!0!==this._getKey("disableMove")&&1!==this._getKey("disableMove"))&&this._sendToAs("addPlugin",{name:"PanoOverlay",options:{url:L+"PanoOverlay.swf"}});(!this._getKey("disableCompass")||!0!==this._getKey("disableCompass")&&1!==this._getKey("disableCompass"))&&this._sendToAs("addPlugin",{name:"1",options:{url:L+"PanoCompass.swf"}});(!this._getKey("disableLogo")||!0!==this._getKey("disableLogo")&&1!==this._getKey("disableLogo"))&&this._sendToAs("addPlugin",{name:"2",options:{url:L+"PanoLogo.swf"}});(!this._getKey("disableFullScreen")||!0!==this._getKey("disableFullScreen")&&1!==this._getKey("disableFullScreen"))&&this._sendToAs("addPlugin",{name:"3",options:{url:L+"PanoFullScreen.swf"}})};t._addResetFlash=function(){var e={};this._getKey("_setPovValue")&&(e.heading=this._getKey("_setPovValue").heading,e.pitch=this._getKey("_setPovValue").pitch,this._sendToAs("setPanoOptions",e));this._getKey("_setZoomValue")&&this._sendToAs("setPanoOptions",{zoom:parseInt(this._getKey("_setZoomValue"))});for(e=0;e<this._labelsArr.length;e++){var d=this._labelsArr[e];this._sendToAs("addLabel",{id:d.id,lat:u(d.position.lat),lng:d.position.lng*ca,height:d.altitude,content:d.content})}};t._sendToAs=function(e,d,h){if(2<=this.status)try{g(this._getKey("swfId"))[h?"sendToPlugin":"sendToAS"](e,d)}catch(k){}else d=Pa({},d),this.waitQuene.push({eventName:e,data:d,tp:h})};t._sendToPlugin=function(e,d){this._sendToAs(e,d,!0)};t.checkCommunication=function(){try{g(this._getKey("swfId")).callBackToAS("checkCommunication")}catch(e){var d=this._getKey("panoContainer"),h=document.createElement("div");h.innerHTML="API\\u7a0b\\u5e8f\\u65e0\\u6cd5\\u4e0eflash\\u901a\\u4fe1\\uff0c\\u5bfc\\u81f4\\u8857\\u666f\\u53ef\\u80fd\\u65e0\\u6cd5\\u6b63\\u5e38\\u4f7f\\u7528\\uff0c\\u8fd9\\u53ef\\u80fd\\u548cflash\\u5b89\\u5168\\u7b56\\u7565\\u6709\\u5173,\\u8bf7\\u53c2\\u8003<a href=\'http://open.map.qq.com/javascript_v2/guide-pano.html#link-two\' target=\'_blank\' style=\'color:#7CCD7C;text-decoration:none \'>\\u89e3\\u51b3\\u6b65\\u9aa4</a>\\u3002";h.style.width="255px";h.style.height="45px";h.style.position="absolute";h.style.backgroundColor="black";h.style.color="#FFFFFF";h.style.fontSize="13px";h.style.padding="5px";h.style.opacity=.5;h.style.filter="alpha(opacity=50)";h.style.left=d.offsetWidth/2-127.5+"px";h.style.top="10px";d.appendChild(h)}};t._receiveFromSwf=function(e,d){switch(e){case"interface_ready":this._onInterfaceReady();this._addResetFlash();this._addDefalutPlugin();if(this._getKey("_setPanoValue")&&this._getKey("_setPanoValue").svid!=d.svid){var g=this._getKey("_setPanoValue").svid;this.setPano(g)}this._isFristLoadFlash&&(this._isFristLoadFlash=!1,this.view.fireEvent("loaded",null,this.view));break;case"pano_model_error":this.view.fireEvent("error",null,this.view);break;case"pano_changed":if(d.chartId&&0<d.bestChartLevel){var g=[d.minx/ca,x(d.miny),d.maxx/ca,x(d.maxy)],h=parseFloat(d.lat),k=parseFloat(d.lng),m={};m.lat=x(h);m.lng=k/ca;this._setKey("planeInfo",{bounds:g,minZoom:d.minZoom,maxZoom:d.maxZoom,zoomLevel:d.bestChartLevel,regionId:d.chartId,forwardMatrix:d.forwardMatrix,backwardMatrix:d.backwardMatrix,center:m})}else this._setKey("planeInfo",null);g={};g.dir=d.dir||0;g.x=d.lng||0;g.y=d.lat||0;g.svid=d.svid||"-1";g.mode=d.mode||"day";g.photoTime=d.photoTime||"0000.00";g.sno=d.sno||"-1";g.source=d.source||"qq";this.pano_changed(g);break;case"pov_changed":this.pov_changed(d);break;case"zoom_changed":this.zoom_changed(d.zoom);break;case"label_mouse_over":this._labels[d.id]&&this.view.fireEvent("labelEvent",{id:d.id,type:"mouseover",viewBounds:d.bounds});break;case"label_mouse_out":this._labels[d.id]&&this.view.fireEvent("labelEvent",{id:d.id,type:"mouseout",viewBounds:d.bounds});break;case"label_mouse_click":this._labels[d.id]&&this.view.fireEvent("labelEvent",{id:d.id,type:"click",viewBounds:d.bounds});break;case"thumb_loaded":this._isFirstChange&&(this._isFirstChange=!1);this.view.fireEvent("thumb_loaded",d,this.view);break;case"autoPlayStop":this.view.fireEvent("autoPlayStop",d,this.view);break;case"dragStart":this.view.fireEvent("dragstart",d,this.view);break;case"dragEnd":this.view.fireEvent("dragend",d,this.view);break;default:this.view.fireEvent(e,d,this.view)}};t._genId=function(){var d=ga++,g="_panoSwfCallback_"+d;this._setKey("swfId","_panoSwf_"+d);this._setKey("swfCallbackId",g)};t._bindSwfCallback=function(){var d=this._getKey("swfCallbackId"),g=this;window[d]=function(d,e){return g._receiveFromSwf(d,e)}};t._initEvents=function(){var d=this._getKey("panoContainer"),g=this;this._getKey("scrollwheel")&&(this._wheelListener=ua.addScrollEvent(d,S?"DOMMouseScroll":"mousewheel",function(h){h=h||window.event;var k;ta?k=[h.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft),h.clientY+(document.documentElement.scrollTop||document.body.scrollTop)]:h.touches?(k=null,0<h.targetTouches.length?k=h.targetTouches[0]:0<h.changedTouches.length&&(k=h.changedTouches[0]),k=[k.pageX,k.pageY]):k=[h.pageX,h.pageY];var m;if(null===d.parentNode||"none"==d.style.display)m=[0,0,0,0];else{var p=null,t=0,u=0;m=d.offsetWidth;var x=d.offsetHeight;if(d.getBoundingClientRect)p=d.getBoundingClientRect(),u=Math.max(document.documentElement.scrollTop,document.body.scrollTop),t=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),t=p.left+t,u=p.top+u;else{if(document.getBoxObjectFor)p=document.getBoxObjectFor(d),t=d.style.borderLeftWidth?parseInt(d.style.borderLeftWidth):0,u=d.style.borderTopWidth?parseInt(d.style.borderTopWidth):0,t=p.x-t,u=p.y-u;else{t=d.offsetLeft;u=d.offsetTop;p=d.offsetParent;if(p!=d)for(;p;)t+=p.offsetLeft,u+=p.offsetTop,p=p.offsetParent;if(Oa||P&&"absolute"==d.style.position)t-=document.body.offsetLeft,u-=document.body.offsetTop}for(p=d.parentNode?d.parentNode:null;p&&"BODY"!=p.tagName&&"HTML"!=p.tagName;)t-=p.scrollLeft,u-=p.scrollTop,p=p.parentNode?p.parentNode:null}m=[t,u,m,x]}2<=g.status&&(x=0,h.wheelDelta?x=h.wheelDelta/120:h.detail&&(x=-h.detail/3),g._sendToAs("mouseWheel",{delta:x,mouseX:k[0]-m[0],mouseY:k[1]-m[1]}));h.preventDefault?h.preventDefault():h.returnValue=!1}))};Ma.$setExports(d)');
