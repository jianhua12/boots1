(function(){"use strict";function nb(d){for(var g=[],k=0,m=d.length;k<m;k++)g.push(ob+d[k]+".js");if(pb){d=[];for(k=Math.ceil(g.length/za);k--;)d.push(qb+g.splice(0,za).join(","));return d}k=0;for(m=g.length;k<m;k++)g[k]=Aa+g[k];return g}function rb(d,g){if(d)return function(){--d||g()};g()}function Ba(d){if(!Ca[d]){Ca[d]=!0;for(var g=L[d],k=g.length;k--;)Ba(g[k]);Da.push(d);Ea||(Ea=setTimeout(sb,0))}}function tb(d){var g=document.createElement("script");g.setAttribute("type","text/javascript");g.setAttribute("src",d);g.setAttribute("charset","utf-8");document.getElementsByTagName("head")[0].appendChild(g)}function sb(){Ea=0;var d=Da;Da=[];d.sort(function(d,g){return d<=g});for(var d=nb(d),g=d.length;g--;)tb(d[g])}function Xa(){"complete"==O.readyState&&(O.detachEvent("onreadystatechange",Xa),u.fireReady())}function Fa(){O.removeEventListener("DOMContentLoaded",Fa,!1);u.fireReady()}function ub(d,g){var k=document.getElementsByTagName("head")[0],m='<script src="'+d+'" '+ka+'="this.ownerDocument.z = 1"></script>',Ga=pa.createElement("iframe");Ga.style.display="none";k.appendChild(Ga);var h=Ga.contentDocument;Ga.onload=function(){1!=h.z&&g&&g();Ga.onload=null;k.removeChild(this)};try{h.write(m),h.close()}catch(Ya){}k=null}function vb(d,g,k,m,h){var x=pa.createElement("script");qa.push({name:d,sender:x});x.setAttribute("type","text/javascript");x.setAttribute("charset",h||"gbk");x.async=!0;var Ya=null,u=!1;x[ka]=function(){wb.test(this.readyState)&&(la(d),Ya?k&&k(Ya):u||m&&m())};Ha[d]=function(d){Ya=d};x.onerror=function(){u=!0;m&&m();la(d)};h=["output=jsonp","fr=mapapi","cb="+Za+"."+d];h=g+(-1===g.indexOf("?")?"?":"&")+h.join("&");x.src=h;xb&&ub(g,function(){x.onerror()});g=document.getElementsByTagName("head")[0];g.insertBefore(x,g.firstChild);g=null}function la(d){if(d){for(var g=0,k=qa.length,m=null;g<k;g++)if(qa[g].name===d){m=qa.splice(g,1)[0];break}m&&(g=m.sender,g.clearAttributes&&g.clearAttributes(),g[ka]=g.onerror=null,g.parentNode&&g.parentNode.removeChild(g));Ha[d]&&delete Ha[d]}}function Ia(){return/\bmobile\b/i.test(navigator.userAgent)}var ob="/mods/",Aa=("https:"==window.location.protocol?"https://":"http://")+"s.map.qq.com/TPano/v1.1.2",pb=!1,L={TPano:[],h5:["TPano"],flash:["TPano"]},qb=Aa+"c/=/",za=5,Ja={},R={},Ka={},G;for(G in L)if(L.hasOwnProperty(G)){var h=L[G];h[0]&&(Ja[h[0]]=!0);Ka[G]=[];R[G]=R[G]||[];for(var $a=h.length;$a--;){var La=h[$a];R[La]?R[La].push(G):R[La]=[G]}}var S={},ra={},ab,sa={};window.__mjsload=function(d,g){if(!S.hasOwnProperty(d)){var k=L[d],m=R[d],h=rb(k.length,function(){var k=g;ab=d;Ja[d]&&(k+=";(0,function(){return eval(arguments[0])})");k=ra[L[d][0]](k);ra[d]||(ra[d]=k);S.hasOwnProperty(d)||(S[d]=void 0);for(var k=Ka[d],h=0,x=k.length;h<x;h++)k[h](S[d]);for(k=m.length;k--;)if(h=m[k],sa[h])sa[h]()});sa[d]=h;for(var x=k.length;x--;)S.hasOwnProperty(k[x])&&h()}};var Ca={},Da=[],Ea,Ma={$require:function(d,g,k){S.hasOwnProperty(d)?(d=S[d],g(void 0===k?d:d[k])):(Ba(d),Ka[d].push(void 0===k?g:function(d){g(d[k])}))},$initMain:function(d,g){ra[d]=g;Ca[d]=!0;S[d]=void 0},$setExports:function(d){S[ab]=d}};Ma.$initMain("TPano",function(){return eval(arguments[0])});var Na={getItem:function(d){if((d=document.cookie.match(RegExp("\\b"+d+"=([^;]*)")))&&1<d.length)return decodeURIComponent(d[1])},set:function(d,g){document.cookie=d+"="+encodeURIComponent(g)}},yb="https:"==window.location.protocol?"https://":"http://",bb="",ma=navigator.userAgent,ta=/msie (\d+\.\d+)/i.test(ma)?document.documentMode||+RegExp.$1:0,u=[],O=document;u.isReady=!1;u._used=!1;u.ready=function(d){u.initReady();u.isReady?d():u.push(d)};u.initReady=function(){if(!u._used){u._used=!0;if("complete"===O.readyState||"interactive"===O.readyState)return u.fireReady();if(0<ta&&9>ta){O.attachEvent("onreadystatechange",Xa);var d=function(){if(!u.isReady){var g=new Image;try{g.doScroll()}catch(k){setTimeout(d,64);return}u.fireReady()}};d()}else O.addEventListener("DOMContentLoaded",Fa,!1)}};u.fireReady=function(){if(!u.isReady){if(!O.body)return setTimeout(u.fireReady,16);u.isReady=!0;if(u.length)for(var d=0,g;g=u[d];d++)g()}};var zb=u.ready,Oa=/opera(\/| )(\d+(\.\d+)?)(.+?(version\/(\d+(\.\d+)?)))?/i.test(ma)?+(RegExp.$6||RegExp.$2):0;new Function;var pa=window.document,wb=/loaded|complete|undefined/i,ka=pa.dispatchEvent?"onload":"onreadystatechange",xb=0<Oa,Za="QQPanoLoader",Ha=window[Za]={},qa=[],Ab=0,Pa=function(d,g,k){for(var m in g)!g.hasOwnProperty(m)||!k&&d.hasOwnProperty(m)||(d[m]=g[m]);return d},ua={addListener:function(d,g,k){var m=this._dora_events=this._dora_events||{};m[g]=m[g]||[];m[g].push({action:k,context:d||this});return this},hasEventListeners:function(d){return"_dora_events"in this&&d in this._dora_events&&0<this._dora_events[d].length},removeEventListener:function(d,g,k){if(!this.hasEventListeners(g))return this;for(var m=0,h=this._dora_events,x=h[g].length;m<x;m++)if(h[g][m].action===k&&(!d||h[g][m].context===d)){h[g].splice(m,1);break}return this},fireEvent:function(d,g,k){if(!this.hasEventListeners(d))return this;d=this._dora_events[d].slice();for(var m=0,h=d.length;m<h;m++)k&&d[m].context!=k||d[m].action.call(d[m].context||this,g);return this},addScrollEvent:function(d,g,k){d.addEventListener&&d.addEventListener(g,k,!1);d.onmousewheel=k}},Qa=function(d,g){return function(k){new k(d,g)}},Bb={send:function(d,g,k,m){d||(d="cb"+(new Date).getTime().toString(36)+(Ab++).toString(36));zb(function(){la(d);vb(d,g,k,m)});return d},cancel:la};G={init:function(d){bb=d},report:function(d,g){var k;(k=Na.getItem("suid"))||(k=(new Date).getUTCMilliseconds(),k=Math.round(2147483647*Math.random())*k%1e10,Na.set("suid",k));var m=k;k=new Image(1,1);m={appid:bb,suid:m,logid:d,rand:Math.random()};if(g)for(var h in g)m[h]=g[h];h=yb+"pr.map.qq.com/pingd?";var x,u=[];for(x in m)u.push(x+"="+encodeURIComponent(m[x]));x=u.join("&");k.src=h+x},downTPanoAPI:function(){this.report("tpanoapi_mainjs_download")}};h="https:"==window.location.protocol?"https://":"http://";G.init("TPanoAPI");G.downTPanoAPI();var Cb=h+"apikey.map.qq.com/mkey/index.php/mkey/check",Db={pano:null,zoom:1,scrollwheel:!0,disableLogo:!1,disableCompass:!1,disableFullScreen:!1,disableMove:!1,container:null,visible:!0,key:"",renderer:null,pf:"",from:"",ch:""},Eb={id:function(){var d=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return d()+d()+d()+d()+d()+d()+d()+d()}(),content:"",position:{lat:0,lng:0},altitude:5,visible:!0};G=function(d){d=Pa(d,Db);this._waitQuene=[];Ia()?Ma.$require("h5",Qa(this,d)):Ma.$require("flash",Qa(this,d));ua.addListener(this,"loaded",function(){if(!this._render)throw Error("Fatal Error! Render loaded but render not set correctly.");for(var d=this.getPano(),k=0,m=this._waitQuene.length;k<m;k++){var h=this._waitQuene[k];h.func.apply(h.scope,h.args)}d&&(this._waitQuene=null)})};h=G.prototype;h.setPov=function(d,g){var k={},m=!1;null==d||isNaN(Number(d))||(k.heading=Number(d),m=!0);null==g||isNaN(Number(g))||(k.pitch=Number(g),m=!0);m&&(this._render?this._render.setPov(k):this._waitQuene.push({args:arguments,scope:this,func:this.setPov}))};h.setPano=function(d){this._render?this._render.setPano(d):this._waitQuene.push({args:arguments,scope:this,func:this.setPano})};h.setZoom=function(d){this._render?this._render.setZoom(d):this._waitQuene.push({args:arguments,scope:this,func:this.setZoom})};h.setThumb=function(d){!d instanceof Object||(this._render?this._render.setThumb(d):this._waitQuene.push({args:arguments,scope:this,func:this.setThumb}))};h.updateViewport=function(){this._render?this._render.updateViewport&&this._render.updateViewport():this._waitQuene.push({args:arguments,scope:this,func:this.updateViewport})};h._removePano=function(){this._render?this._render.removePano():this._waitQuene.push({args:arguments,scope:this,func:this.removePano})};h.getPov=function(){if(this._render)return this._render._getKey("pov")};h.getPano=function(){if(this._render)return this._render._getKey("pano")};h.getZoom=function(){if(this._render)return this._render._getKey("zoom")};h.getPosition=function(){if(this._render)return this._render._getKey("position")};h.setVisible=function(d){this._render?this._render.setVisible(d):this._waitQuene.push({args:arguments,scope:this,func:this.setVisible})};h.fireEvent=function(d,g,k){ua.fireEvent(d,g,k||this)};h.getPanoContainer=function(){if(this._render)return this._render._getKey("panoContainer")};h.addLabel=function(d){var g=Pa(d,Eb);this._render?this._render.addLabel(g):this._waitQuene.push({args:arguments,scope:this,func:this.addLabel})};h.addMarker=function(d){if(!Ia())throw Error("not suport addMarker function on mobile!");if(this._render)return this._render.addMarker(d);this._waitQuene.push({args:arguments,scope:this,func:this.addMaker})};h.removeMarker=function(d){if(!Ia())throw Error("not suport removeMarker function on mobile!");this._render?this._render.removeMarker(d):this._waitQuene.push({args:arguments,scope:this,func:this.removeMarker})};h.removeLabel=function(d){this._render?this._render.removeLabel(d):this._waitQuene.push({args:arguments,scope:this,func:this.removeLabel})};h._addPlugin=function(d){this._render?this._render.addPlugin(d):this._waitQuene.push({args:arguments,scope:this,func:this._addPlugin})};h.autoPlayStart=function(d){this._render?this._render.autoPlayStart(d):this._waitQuene.push({args:arguments,scope:this,func:this.autoPlayStart})};h.autoPlayStop=function(){this._render?this._render.autoPlayStop():this._waitQuene.push({args:arguments,scope:this,func:this.autoPlayStop})};h._setFailKey=function(d){this._render?this._render.setKeyStatus({status:0}):this._waitQuene.push({args:arguments,scope:this,func:this._setFailKey})};h._vertifyKey=function(d){if(!d)this._setFailKey();else if(location.host){var g=this;Bb.send(null,Cb+"?key="+d,function(d){d&&d.info&&0===d.info.error||d&&d.info&&g._setFailKey()})}};h=window.qq||(window.qq={});h.pano=h.pano||{};h.pano.Panorama=G;h.pano.event=ua;})();
